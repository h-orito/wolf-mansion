# アクティブコンテキスト (Active Context)

## 現在の作業の焦点

現在のWOLF MANSIONフロントエンドプロジェクトは、初期開発段階にあります。主な焦点は以下の通りです：

1. **基本的なUI実装**: メインページ、村一覧、ユーザーメニューなどの基本的なUIコンポーネントの実装
2. **APIとの連携**: バックエンドAPIとの通信機能の実装
3. **型定義の整備**: OpenAPIを使用した型定義の自動生成と活用
4. **ユーザー認証**: ログイン、ID登録、パスワード変更、ログアウト機能の実装

## 最近の変更

現時点では、以下の機能が実装されています：

1. **メインページ**: トップページのレイアウトとナビゲーションリンク
2. **村一覧機能**: APIから村一覧を取得し、トップページに表示する機能
   - 村番号と村名を「{村番号}. {村名}」の形式で表示
   - タグをアウトラインスタイルで表示し、危険レベルのタグは赤色で区別
   - 参加人数とステータスの表示
   - 既存のUIデザインに合わせたスタイリング
3. **APIクライアント**: バックエンドAPIとの通信を行うための基本的なHTTPリクエスト関数
4. **基本的なUIコンポーネント**:
   - モーダルコンポーネント（ダークテーマ、モーダル外クリックで閉じる、ESCキーで閉じる）
   - ボタンコンポーネント（複数のバリアントとサイズ、ローディング状態）
   - アラートコンポーネント（複数のバリアントを持ち、エラーメッセージや成功メッセージの表示に使用）
5. **ユーザー認証機能**:
   - ログインモーダル、ID登録モーダル、パスワード変更モーダル
   - 認証状態管理フック（useAuth）
   - ログイン状態に応じたUI表示
   - ログイン中はユーザー名を常に表示するLoginIndicator

## 次のステップ

プロジェクトを進めるための次のステップは以下の通りです：

1. **ユーザープロフィール管理の実装**: ユーザープロフィールページの実装
2. **村詳細ページの実装**: 個別の村の詳細情報を表示するページの実装
3. **ゲームプレイ画面の実装**: 実際のゲームプレイを行うための画面の実装
4. **既知の問題の修正**: ログアウト処理やマイページへのリンクの問題を修正

## アクティブな決定と考慮事項

現在のプロジェクトでは、以下の決定と考慮事項が重要です：

1. **コンポーネント設計**: UIコンポーネントの粒度と再利用性のバランスを考慮した設計
2. **状態管理**: ゲーム状態の管理方法（React Contextを使用するか、別の状態管理ライブラリを導入するか）
3. **リアルタイム通信**: ゲーム進行中のリアルタイム更新をどのように実装するか（WebSocketの導入を検討）
4. **レスポンシブデザイン**: モバイルデバイスでの使いやすさを確保するためのUIデザイン
5. **認証状態の管理**: ユーザーの認証状態をどのように管理するか（現在はuseAuthフックを使用）

## 現在の課題

1. **ユーザー認証の問題**: ログアウト処理がAPI側の問題で正しく機能していない可能性があり、マイページへのリンクが404エラーになる問題があります。
2. **ゲームプレイ画面**: 複雑なゲームロジックをフロントエンドでどのように表現するかの設計が必要です。
3. **セキュリティ対策**: パスワード入力フィールドに`autocomplete="new-password"`属性の追加やCSRFトークンの実装が必要です。

## 技術的な注意点

1. **型安全性**: OpenAPIから生成された型定義を最大限に活用し、型エラーを早期に検出することが重要です。
2. **パフォーマンス**: 特にゲームプレイ画面では、不必要な再レンダリングを避け、パフォーマンスを最適化する必要があります。
3. **エラーハンドリング**: APIリクエストのエラーを適切に処理し、ユーザーに分かりやすいエラーメッセージを表示する必要があります。
4. **クライアントコンポーネントとサーバーコンポーネントの分離**: Next.jsのサーバーコンポーネントとクライアントコンポーネントを適切に分離し、パフォーマンスとSEOを最適化する必要があります。

このアクティブコンテキストは、プロジェクトの進行に伴って定期的に更新されます。
